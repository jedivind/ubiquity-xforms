<!--
  * Copyright (C) 2008 Backplane Ltd.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *  http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
-->
<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:xf="http://www.w3.org/2002/xforms"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:fp="urn:formsplayer.com"
>
	<head>
		<title>Initialisation events</title>
		<script type="text/javascript" src="../../../../ubiquity-loader.js" >/**/</script>
	</head>
	<body>
		<xf:model id="mdl-test-data" functions="fp:HTMLSerialise">
			
			<xf:instance id="inst-test-data">
				<data xmlns="">
					<xf-model-construct>FALSE</xf-model-construct>
					<xf-model-construct-done>FALSE</xf-model-construct-done>
					<xf-ready>FALSE</xf-ready>
					<xf-model-destruct>FALSE</xf-model-destruct>
				</data>
			</xf:instance>
			
			<xf:action ev:event="xforms-model-construct">
				<xf:message level="modal">
					<h3>xform-model-construct for mdl-test-data</h3>
				</xf:message>
				<!-- xf:setvalue 
					ref="/data/xf-model-construct" 
					value="'TRUE'" 
					/ -->
			</xf:action>
			
			<xf:action ev:event="xforms-model-construct-done">
				<xf:setvalue 
					ref="/data/xf-model-construct-done" 
					value="'TRUE'" 
				></xf:setvalue>
			</xf:action>
			
			<xf:action ev:event="xforms-ready">
				<xf:setvalue 
					ref="/data/xf-ready" 
					value="'TRUE'" 
				></xf:setvalue>
			</xf:action>
			
			<xf:action ev:event="xforms-model-destruct">
				<xf:setvalue 
					ref="/data/xf-model-destruct" 
					value="'TRUE'" 
				></xf:setvalue>
			</xf:action>
			
			<xf:submission 
				id="sub-example"
				method="post"
				action="http://www.example.org"
				replace="all"
				ref="instance('inst-test-data')"
			></xf:submission>
		</xf:model>
		<a href="javascript:window.close();">Cause xforms-model-destruct by closing browser</a>
		<br ></br>
		
		<xf:trigger>
			<xf:label>Cause xforms-model-destruct by xf:submission</xf:label>
			<xf:action ev:event="DOMActivate">
				<xf:send submission="sub-example" ></xf:send>
			</xf:action>
		</xf:trigger>
		<br ></br>
		
		<xf:trigger>
			<xf:label>Cause xforms-model-destruct by xf:load</xf:label>
			<xf:action ev:event="DOMActivate">
				<xf:load resource="http://www.example.org" ></xf:load>
			</xf:action>
		</xf:trigger>
		
		<xf:output value="fp:HTMLSerialise(instance('inst-test-data'))">
			<xf:label>inst-test-data</xf:label>
		</xf:output>
	</body>
</html>