<?xml version="1.0" encoding="utf-8" ?>
<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:xf="http://www.w3.org/2002/xforms"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
	<head>
		<title>Insert action: Inserting attributes</title>
		<script type="text/javascript" src="../../../../ubiquity-loader.js" >/**/</script>
		<style type="text/css">
			xf\:output { display: block; }
		</style>
	</head>
	<body>
		<xf:model id="mdl">
			<xf:instance id="i0">
				<instanceData xmlns="" attr="ok" status="not started">
					<t1 dummy="failed" attr="failed" ></t1>
					<t2 dummy="failed" attr="failed" ></t2>
					<t4 ></t4>
					<t5 dummy="failed" ></t5>
					<t6 ></t6>
					<t7 ></t7>
				</instanceData>
			</xf:instance>
			<xf:bind id="b0" nodeset="*" ></xf:bind>
			<xf:instance id="i1">
				<instanceData xmlns="" attr="ok" status="not started">
					<t1 dummy="failed" attr="failed" ></t1>
					<t2 dummy="failed" attr="failed" ></t2>
					<t4 ></t4>
					<t5 dummy="failed" ></t5>
					<t6 ></t6>
					<t7 ></t7>
				</instanceData>
			</xf:instance>
			<xf:instance id="i2">
				<instanceData xmlns="" attr="ok" status="not started">
					<t1 dummy="failed" attr="failed" ></t1>
					<t2 dummy="failed" attr="failed" ></t2>
					<t4 ></t4>
					<t7 ></t7>
				</instanceData>
			</xf:instance>
			
			<xf:instance id="i3">
				<instanceData xmlns="" attr="ok" status="not started">
					<tz ></tz>
				</instanceData>
			</xf:instance>
			<xf:bind id="b1" nodeset="instance('i2')/*"></xf:bind>
			<xf:action ev:event="test-1">
				<xf:insert bind="b0" ></xf:insert>
				<xf:dispatch target="mdl" name="test-1-complete" ></xf:dispatch>
			</xf:action>
			
			<xf:action ev:event="test-2">
				<xf:insert nodeset="t4|t5|t6" ></xf:insert>
				<xf:dispatch target="mdl" name="test-2-complete" ></xf:dispatch>
			</xf:action>

			<xf:action ev:event="test-3">
				<xf:insert origin="instance('i0')/t6" context="t2" ></xf:insert>
				<xf:dispatch target="mdl" name="test-3-complete" ></xf:dispatch>
			</xf:action>
			
			<xf:action ev:event="test-4">
				<xf:insert nodeset="instance('i1')/*" at="1" position="before" ></xf:insert>
				<xf:dispatch target="mdl" name="test-4-complete" ></xf:dispatch>
			</xf:action>
			
			<xf:action ev:event="test-5">
				<xf:insert nodeset="instance('i1')/*" at="2" position="after" ></xf:insert>
				<xf:dispatch target="mdl" name="test-5-complete" ></xf:dispatch>
			</xf:action>
			<xf:action ev:event="test-6">
				<xf:insert bind="b1" at="1" position="before" ></xf:insert>
				<xf:dispatch target="mdl" name="test-6-complete" ></xf:dispatch>
			</xf:action>
			<xf:action ev:event="test-7">
				<xf:insert bind="b1" at="2" position="after" ></xf:insert>
				<xf:dispatch target="mdl" name="test-7-complete" ></xf:dispatch>
			</xf:action>
			<xf:action ev:event="test-8">
				<xf:insert nodeset="instance('i3')" origin="*" ></xf:insert>
				<xf:dispatch target="mdl" name="test-8-complete" ></xf:dispatch>
			</xf:action>
			

		
			<!--
				Indicate that we're done.
			-->
			<xf:action ev:event="tests-complete">
				<xf:setvalue ref="@status">complete</xf:setvalue>
			</xf:action>
			<!--
				Chain the tests together. We do this because we might at
				some point want to allow each test to be run from a trigger,
				or one test might use the results of a prior test.
			-->
			<xf:dispatch target="mdl" name="test-1" ev:event="xforms-ready" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-2" ev:event="test-1-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-3" ev:event="test-2-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-4" ev:event="test-3-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-5" ev:event="test-4-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-6" ev:event="test-5-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-7" ev:event="test-6-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="test-8" ev:event="test-7-complete" ></xf:dispatch>
			<xf:dispatch target="mdl" name="tests-complete" ev:event="test-8-complete" ></xf:dispatch>
		</xf:model>
		<xf:output id="t1" value="if(count(t7)=2 and t7/following-sibling::t7,'ok','fail')">
			<xf:label>Test 1:</xf:label>
		</xf:output>
		<xf:output id="t2" value="if(count(t6)=2 and t6/following-sibling::t6 ,'ok','fail')">
			<xf:label>Test 2:</xf:label>
		</xf:output>
		<xf:output id="t3" value="if(count(t2/t6) = 2,'ok','fail')">
			<xf:label>Test 3:</xf:label>
		</xf:output>
		<xf:group ref="instance('i1')">
			<xf:output id="t4" value="if(count(t7/following-sibling::t1) = 1,'ok','fail')">
				<xf:label>Test 4:</xf:label>
			</xf:output>
			<xf:output id="t5" value="if(count(t1/following-sibling::t7) = 2,'ok','fail')">
				<xf:label>Test 5:</xf:label>
			</xf:output>
		</xf:group>
		<xf:group ref="instance('i2')">
			<xf:output id="t6" value="if(count(t7/following-sibling::t1) = 1,'ok','fail')">
				<xf:label>Test 6:</xf:label>
			</xf:output>
			<xf:output id="t7" value="if(count(t1/following-sibling::t7) = 2,'ok','fail')">
				<xf:label>Test 7:</xf:label>
			</xf:output>
		</xf:group>
		<xf:output id="t8" value="if(name(instance('i3'))='t1','ok','fail')">
			<xf:label>Test 8:</xf:label>
		</xf:output>
		
		<!--xf:output id="t4" ref="t2/@*[1]">
			<xf:label>Test 4:</xf:label>
		</xf:output>
		<xf:output id="t5" ref="t5/@attr">
			<xf:label>Test 5:</xf:label>
		</xf:output>
		<xf:output id="t6" ref="t6/@attr">
			<xf:label>Test 6:</xf:label>
		</xf:output>
		<xf:output id="t7" ref="t7/@attr">
			<xf:label>Test 7:</xf:label>
		</xf:output-->
		<xf:output id="status" ref="@status">
			<xf:label>Status:</xf:label>
		</xf:output>
	</body>
</html>
