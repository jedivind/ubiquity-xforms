<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:fp="urn:formsplayer.com" 
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:xf="http://www.w3.org/2002/xforms">
	<head>
		<title>Using switch and case to create composite controls</title>
		
		<xf:model>
			<xf:instance id="iData">
				<printerSettings xmlns="">
					<paperSize>0</paperSize>
					<printQuality>1</printQuality>
					<printableArea>0</printableArea>
					<highSpeed>0</highSpeed>
					<halfTone>0</halfTone>
				</printerSettings>
			</xf:instance>

			<xf:instance id="iDefs">
				<resources xmlns="">
					<resource id="paperSize">
						<prompt xml:lang="en">Paper Size</prompt>
						<choices>
							<choice value="0" xml:lang="en">A4</choice>
							<choice value="1" xml:lang="en">A5</choice>
							<choice value="2" xml:lang="en">Legal</choice>
						</choices>
					</resource>
					<resource id="printQuality">
						<prompt xml:lang="en">Print Quality</prompt>
						<choices>
							<choice value="0" xml:lang="en">Fine</choice>
							<choice value="1" xml:lang="en">Normal</choice>
							<choice value="2" xml:lang="en">Economy</choice>
						</choices>
					</resource>
					<resource id="printableArea">
						<prompt xml:lang="en">Printable Area</prompt>
						<choices>
							<choice value="0" xml:lang="en">Maximum</choice>
							<choice value="1" xml:lang="en">Centred</choice>
						</choices>
					</resource>
					<resource id="highSpeed">
						<prompt xml:lang="en">High Speed</prompt>
						<choices>
							<choice value="0" xml:lang="en">Off</choice>
							<choice value="1" xml:lang="en">On</choice>
						</choices>
					</resource>
					<resource id="halfTone">
						<prompt xml:lang="en">Half Tone</prompt>
						<choices>
							<choice value="0" xml:lang="en">Fine Dithering</choice>
							<choice value="1" xml:lang="en">Error Diffusion</choice>
						</choices>
					</resource>
				</resources>
			</xf:instance>

			<xf:bind id="printerSettings" nodeset="*"/>
		</xf:model>
		
		<style type="text/css">
			body {
				font-family			:	"Trebuchet MS", Verdana, Helvetica, sans-serif;
			}
			
			h2 {
				background-color	:	lightblue;
				font-size			:	80%;
			}
			
			.the-demo {
				background-color	:	lightyellow;
				border				:	1px thin solid darkyellow;
				padding				:	5px;
			}
			
			/* an xf:repeat 'row' */
			.repeat-item
			{
				display: block;
			}
		</style>
	</head>
	<body>
		<h1>
			Using switch and case to create composite controls
		</h1>
		<div>
			Using <code>switch</code> and <code>case</code> together, we can create compact custom controls such 
			as those used in the Windows printer configuration dialog boxes.
		</div>
		<div class="the-demo">
     		<p>
     			Despite the <code>repeat</code> unrolling a number of <code>switch</code> and
     			<code>case</code> statements, they all have their own state, and are all correctly
     			accessed.
     		</p>

     		<xf:repeat bind="printerSettings">
     			<xf:output style="display: inline-block;" ref="instance('iDefs')/resource[@id=local-name(current())]/prompt"/>:
     			<xf:switch style="display: inline-block;">
     				<xf:case id="casePrompt">
     					<xf:trigger id="tr" appearance="minimal" style="text-decoration: underline;">
     						<xf:label ref="instance('iDefs')/resource[@id=local-name(current())]/choices/choice[@value=current()]"/>
     						<xf:toggle case="caseEnter" ev:event="DOMActivate"/>
     					</xf:trigger>
     					<xf:setfocus control="tr" ev:event="xforms-select"/>
     				</xf:case>
     				<xf:case id="caseEnter">
     					<xf:select1 id="sel" ref=".">
     						<xf:label/>
     						<xf:itemset nodeset="instance('iDefs')/resource[@id=local-name(current())]/choices/choice">
     							<xf:label ref="."/>
     							<xf:value ref="@value"/>
     						</xf:itemset>
     						<xf:action ev:event="DOMFocusOut">
     							<xf:rebuild/>
     							<xf:toggle case="casePrompt"/>
     						</xf:action>
     					</xf:select1>
     					<xf:setfocus control="sel" ev:event="xforms-select"/>
     				</xf:case>
     			</xf:switch>
     		</xf:repeat>
     		
     	</div>
	</body>
</html>