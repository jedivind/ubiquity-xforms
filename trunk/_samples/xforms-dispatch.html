<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
  // Ubiquity provides a standards-based suite of browser enhancements for
  // building a new generation of internet-related applications.
  //
  // The Ubiquity XForms module adds XForms 1.1 support to the Ubiquity
  // library.
  //
  // Copyright (C) 2008 Backplane Ltd.
  //
  // Licensed under the Apache License, Version 2.0 (the "License");
  // you may not use this file except in compliance with the License.
  // You may obtain a copy of the License at
  //
  //  http://www.apache.org/licenses/LICENSE-2.0
  //
  // Unless required by applicable law or agreed to in writing, software
  // distributed under the License is distributed on an "AS IS" BASIS,
  // WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  // See the License for the specific language governing permissions and
  // limitations under the License.
-->
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ev="http://www.w3.org/2001/xml-events"
  xmlns:xf="http://www.w3.org/2002/xforms"
>
	<head>
		<title>Testing XForms dispatch</title>
		<script type="text/javascript" src="../src/ubiquity-loader.js" >/**/</script>
		<style type="text/css">
	    .sample {
   	      border: 1px solid silver;
  	      background-color: lightyellow;
   	      padding: 30px;
   	      margin-left: 30px;
   	      width: 85%;
	    }
	    pre {
  	      background-color: black;
  	      color: green;
  	      padding: 5px;
  	      overflow: auto;
  	      padding: 30px;
  	      margin-left: 30px;
  	      width: 85%;
  	    }
  	    xf\:output {
  	      margin-top: 10px;
  	    }
	  </style>
	</head>
	<body>
		<xf:model>
			<xf:instance>
				<data xmlns="">
					<number>1</number>
					<name>DOM</name>
					<time>3000</time>
					<target>value_of_target</target>
				</data>
			</xf:instance>
		</xf:model>

		<h1>Testing XForms dispatch</h1>
		<p>
		  The XForms <code>dispatch</code> element is used by form authors to send events
		  to other elements.  The dispatch uses a target variable, a name variable, and a
		  delay variable to send events.  The target variable is the IDREF of an element
		  that the event is going to be sent to.  The name variable is the name of the
		  event that is being sent.  The delay variable is the amount of time that the
		  dispatch must wait before it can send the event.  These variables can be
		  defined by attribute form or element form.
		</p>
		<p>
		  For each of the examples we have below, there is both the markup and a live
		  version of the code; so click the buttons and check the outputs to see how the
		  markup behaves.
		</p>
		<h2>The basic format</h2>
		<p>
		  A simple example has a dispatch with target and name as attributes and no delay
		  variable (which means the event is dispatched instantly):
		  <pre>
		    &lt;xf:group id="simple_example">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="2">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 2.&lt;/xf:label>
		      &lt;xf:dispatch target="simple_example" name="DOM" ev:event="DOMActivate" >&lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="simple_example">
				<xf:setvalue ev:event="DOM" ref="number" value="2"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 2.</xf:label>
	      		<xf:dispatch target="simple_example" name="DOM" ev:event="DOMActivate" ></xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		
		<h2>The name variable examples</h2>
		<p>
		  The name variable can be defined by the name attribute:
		  <pre>
		    &lt;xf:group id="name_attribute">
		      &lt;xf:setvalue ev:event="some name" ref="number" value="4">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 4.&lt;/xf:label>
		      &lt;xf:dispatch target="name_attribute" name="some name" ev:event="DOMActivate" >&lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="name_attribute">
				<xf:setvalue ev:event="some name" ref="number" value="4"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 4.</xf:label>
	      		<xf:dispatch target="name_attribute" name="some name" ev:event="DOMActivate" ></xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<p>
		  The name variable can be defined in the name element:
		  <pre>
		    &lt;xf:group id="name_element">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="5">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 5.&lt;/xf:label>
		      &lt;xf:dispatch target="name_element" ev:event="DOMActivate" >
		      	&lt;xf:name>DOM&lt;/xf:name>
		      &lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="name_element">
				<xf:setvalue ev:event="DOM" ref="number" value="5"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 5.</xf:label>
	      		<xf:dispatch target="name_element" ev:event="DOMActivate">
	      			<xf:name>DOM</xf:name>
	      		</xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<p>
		  The name variable can be defined in the value attribute of the name element:
		  <pre>
		    &lt;xf:group id="value_of_name">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="6">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 6.&lt;/xf:label>
		      &lt;xf:dispatch target="value_of_name" ev:event="DOMActivate" >
		      	&lt;xf:name value="/data/name">&lt;/xf:name>
		      &lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="value_of_name">
				<xf:setvalue ev:event="DOM" ref="number" value="6"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 6.</xf:label>
	      		<xf:dispatch target="value_of_name" ev:event="DOMActivate">
	      			<xf:name value="/data/name"></xf:name>
	      		</xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		
		<h2>The target variable examples</h2>
		<p>
		  The target variable can be defined by the target attribute:
		  <pre>
		    &lt;xf:group id="target_attribute">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="14">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 14.&lt;/xf:label>
		      &lt;xf:dispatch target="target_attribute" name="DOM" ev:event="DOMActivate" >&lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="target_attribute">
				<xf:setvalue ev:event="DOM" ref="number" value="14"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 14.</xf:label>
	      		<xf:dispatch target="target_attribute" name="DOM" ev:event="DOMActivate" ></xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<p>
		  The target variable can be defined in the target element:
		  <pre>
		    &lt;xf:group id="target_element">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="15">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 15.&lt;/xf:label>
		      &lt;xf:dispatch name="DOM ev:event="DOMActivate" >
		      	&lt;xf:target>target_element&lt;/xf:target>
		      &lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="target_element">
				<xf:setvalue ev:event="DOM" ref="number" value="15"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 15.</xf:label>
	      		<xf:dispatch name="DOM" ev:event="DOMActivate">
	      			<xf:target>target_element</xf:target>
	      		</xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<p>
		  The target variable can be defined in the value attribute of the target element:
		  <pre>
		    &lt;xf:group id="value_of_target">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="16">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to set the number to 16.&lt;/xf:label>
		      &lt;xf:dispatch name="DOM ev:event="DOMActivate" >
		      	&lt;xf:target value="/data/target">&lt;/xf:target>
		      &lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="value_of_target">
				<xf:setvalue ev:event="DOM" ref="number" value="16"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to set the number to 16.</xf:label>
	      		<xf:dispatch name="DOM" ev:event="DOMActivate">
	      			<xf:target value="/data/target"></xf:target>
	      		</xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		
		<h2>The delay variable examples</h2>
		<p>
		  The delay variable can be defined in attribute form on the dispatch element:
		  <pre>
		    &lt;xf:group id="delay_attribute">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="24">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to delay and set the number to 24.&lt;/xf:label>
		      &lt;xf:dispatch target="delay_attribute" name="DOM" ev:event="DOMActivate" delay="3000">&lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="delay_attribute">
				<xf:setvalue ev:event="DOM" ref="number" value="24"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to delay and set the number to 24.</xf:label>
	      		<xf:dispatch target="delay_attribute" name="DOM" ev:event="DOMActivate" delay="3000"></xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<p>
		  The delay variable can be defined in the delay element:
		  <pre>
		    &lt;xf:group id="delay_element">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="25">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to delay and set the number to 25.&lt;/xf:label>
		      &lt;xf:dispatch target="delay_element" name="DOM" ev:event="DOMActivate" >
		      	&lt;xf:delay>3000&lt;/xf:delay>
		      &lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="delay_element">
				<xf:setvalue ev:event="DOM" ref="number" value="25"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to delay and set the number to 25.</xf:label>
	      		<xf:dispatch target="delay_element" name="DOM" ev:event="DOMActivate">
	      			<xf:delay>3000</xf:delay>
	      		</xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<p>
		  The delay variable can be defined in the value attribute of the delay element:
		  <pre>
		    &lt;xf:group id="value_of_delay">
		      &lt;xf:setvalue ev:event="DOM" ref="number" value="26">&lt;/xf:setvalue>
		    &lt;/xf:group>
		    &lt;xf:trigger>
		      &lt;xf:label>Click to delay and set the number to 26.&lt;/xf:label>
		      &lt;xf:dispatch target="value_of_delay" name="DOM" ev:event="DOMActivate" >
		      	&lt;xf:delay value="/data/time">&lt;/xf:delay>
		      &lt;/xf:dispatch>
		    &lt;/xf:trigger>
		  </pre>
		  <div class="sample">
			<xf:group id="value_of_delay">
				<xf:setvalue ev:event="DOM" ref="number" value="26"></xf:setvalue>
			</xf:group>
			<xf:trigger>
				<xf:label>Click to delay and set the number to 26.</xf:label>
	      		<xf:dispatch target="value_of_delay" name="DOM" ev:event="DOMActivate">
	      			<xf:delay value="/data/time"></xf:delay>
	      		</xf:dispatch>
			</xf:trigger>
			<xf:output ref="number">
				<xf:label>Number:</xf:label>
			</xf:output>
		  </div>
		</p>
		<h2>Further reading</h2>
		<p>
		  For more information see the <a href="http://www.w3.org/TR/xforms11/#action-dispatch">
		  definition of dispatch in the XForms 1.1 specification</a>.
		</p>
	</body>
</html>
