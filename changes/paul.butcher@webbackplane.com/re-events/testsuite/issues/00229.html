<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <head>
        <title>Issue 229</title>
        
    <script  src="../../src/ubiquity-loader.js" type="text/javascript">/**/</script>
    <link href="../../../driverPages/forms/TestSuite11.css" rel="stylesheet"/>
    </head>
    <body>
      <ol>
        <li>Activate the trigger labelled "Reset"</li>
        <li>If a set of outputs can be seen, with the same values as these items...
          <ul>
            <li>xforms-reset: xforms-reset</li>
            <li>xforms-rebuild: xforms-rebuild</li>
            <li>xforms-recalculate: xforms-recalculate</li>
            <li>xforms-revalidate: xforms-revalidate</li>
            <li>xforms-refresh: xforms-refresh</li>
          </ul>
          ... the test has passed
        </li>
      </ol>
    <xf:model id="m0">
            <xf:instance>
                <inst>
                  <rebuild>NOT DONE</rebuild>
                  <recalculate>NOT DONE</recalculate>
                  <revalidate>NOT DONE</revalidate>
                  <refresh>NOT DONE</refresh>
                </inst>
            </xf:instance>
            <xf:instance id="inst-ready">
              <inst>TRUE</inst>
            </xf:instance>
            <!-- the following actions are supposed to occur after xforms-reset event -->
      <xf:setvalue ref="rebuild" ev:event="xforms-rebuild">xforms-rebuild</xf:setvalue>
      <xf:setvalue ref="recalculate" ev:event="xforms-recalculate">xforms-recalculate</xf:setvalue>
      <xf:setvalue ref="revalidate" ev:event="xforms-revalidate">xforms-revalidate</xf:setvalue>
      <xf:setvalue ref="refresh" ev:event="xforms-refresh">xforms-refresh</xf:setvalue>
    </xf:model>
      <!--
        This is a separate model, as anything actioned by a reset event will be overwritten by 
        the default behaviour of xforms-reset.
      -->
      <xf:model id="m1">
        <xf:instance id="reset-instance">
          <inst>NOT DONE</inst>
        </xf:instance>
      </xf:model>
      
      <xf:setvalue model="m1" ref="instance('reset-instance')" ev:observer="m0" ev:event="xforms-reset">xforms-reset</xf:setvalue> 

      <hr />    
      <xf:output model="m1" ref="instance('reset-instance')" id="reset-result">
        <xf:label>xforms-reset: </xf:label>
      </xf:output>
      <xf:repeat nodeset="*" model="m0">
        <xf:output ref="."><xf:label value="concat('xforms-', local-name(.), ': ')"></xf:label></xf:output>
      </xf:repeat>
      <hr />
      <xf:trigger id="reset">
        <xf:label>Reset</xf:label>
        <xf:reset model="m0" ev:event="DOMActivate"></xf:reset>
      </xf:trigger>
      
      <xf:output ref="instance('inst-ready')" id="ready">
        <xf:label>Ready: </xf:label>
      </xf:output>
      
      
    </body>
</html>
