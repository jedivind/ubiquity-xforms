<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ev="http://www.w3.org/2001/xml-events"
	xmlns:xf="http://www.w3.org/2002/xforms"
	xmlns:wfa="http://www.w3.org/TR/webforms-a"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-Instance">
<head>
<script src="../../ubiquity-loader.js" type="text/javascript">/**/</script>
<link type="text/css" href="style/gen_default.css" rel="stylesheet"></link>
</head>
<body>

<xf:model id="m1">
</xf:model>

<xf:form id="f" wfa:name="datarecord"
	action="http://xformstest.org/cgi-bin/echo.sh" method="post">

	<xf:input id="d" wfa:name="startdate" wfa:datatype="date"
		wfa:value="08/08/2008">
		<xf:label>Agreement Date:</xf:label>
	</xf:input>
	<br />
	<xf:group id="b" wfa:name="borrower">
		<xf:input id="name" wfa:name="name" wfa:datatype="string"
			wfa:value="Joe Q. Public" wfa:constraint="string-length(.) > 0">
			<xf:label for="name">Name:</xf:label>
		</xf:input>
		<br />
		<xf:input id="addr" wfa:name="addr" wfa:datatype="string"
			wfa:value="123 Main St. Tinyville"
			wfa:constraint="string-length(.) > 0">
			<xf:label for="addr">Address:</xf:label>
		</xf:input>
		<br />
	</xf:group>
	<xf:input id="p" wfa:name="principal" wfa:datatype="double" wfa:value="10000"
		wfa:constraint=". &gt;= 1000 and . &lt;= 100000">
		<xf:label for="addr">Principal:</xf:label>
	</xf:input>

	<br />
	<!-- 
   <xf:label for="currency">Choose currency</xf:label>
   <xf:select name="currency" >
     <xf:option value="USD">US Dollars</xf:option>
     <xf:option value="CDN">Canadian Dollars</xf:option>
     <xf:option value="EUR">Euros</xf:option>
   </xf:select>
   <br />
   -->

	<xf:group id="t" wfa:name="terms">
		<xf:input id="d" wfa:name="duration" wfa:datatype="integer" wfa:value="12"
			wfa:constraint=". &gt; 0 and . &lt;= 84">
			<xf:label>Duration of Loan in Months:</xf:label>
		</xf:input>
     <br></br>
		<xf:input id="in" wfa:name="interestrate" wfa:datatype="double" wfa:value="5"
			wfa:constraint=". &gt;= 5 and . &lt;= 60">
			<xf:label>Yearly Interest Rate:</xf:label>
		</xf:input>
	</xf:group>
	<br></br>
	<xf:submit id="S">
		<xf:label for="submit">Apply Loan</xf:label>
	</xf:submit>
</xf:form>
<hr size="6" class="rule"></hr>

<!--  It's a hack to use .. for reference of a value, WebForms-A  
      should generate the proper bind which will be part of the second phase impl.  
-->
<xf:output id="o1" wfa:name="rates"
	wfa:calculate="../terms/interestrate div 1200.0">
	<xf:label>Yearly Interest Rate:</xf:label>
</xf:output>
<xf:output id="o2" wfa:name="totalpayout"
	wfa:calculate="ceiling(../principal + (125 * ../terms/interestrate * (../terms/duration * 0.1)))">
	<xf:label>Total Payout:</xf:label>
</xf:output>
<xf:output id="o3" wfa:name="monthly-payment"
	wfa:calculate="ceiling(../totalpayout div ../terms/duration)">
	<xf:label>Monthly Payment:</xf:label>
</xf:output>

<hr size="6" class="rule"></hr>
<script>
    function showSLModel() {
        var model = document.getElementById("m1");
        var instDoc = model.getInstanceDocument();
        var str = xmlText(instDoc.documentElement);
        
        if (console.log) {
            console.log("======== instance  =======");
            console.log(str);
            console.log("==========================");
        } else {
            alert(str);
        }
    }
    </script>
<input type="button" value="show model" onclick="showSLModel()" />
</body>
</html>